{-# OPTIONS --safe --cubical #-}

module Weakening.Presheaf.Model where

open import Agda.Primitive
open import Syntax.Terms
open import Weakening.Presheaf
open import Weakening.Presheaf.Category


record PshModel : Setâ‚ where
  field
    âŸ¦oâŸ§ : Pshw

  âŸ¦_âŸ§C : Con â†’ Pshw
  âŸ¦_âŸ§T : Ty â†’ Pshw
  âŸ¦ â— âŸ§C = ğŸ™p
  âŸ¦ Î“ , A âŸ§C = âŸ¦ Î“ âŸ§C Ã—p âŸ¦ A âŸ§T
  âŸ¦ o âŸ§T = âŸ¦oâŸ§
  âŸ¦ A âŸ¶ B âŸ§T = âŸ¦ A âŸ§T â‡’p âŸ¦ B âŸ§T

  âŸ¦_âŸ§type : term-index â†’ Set _
  âŸ¦ Tm-i Î“ A âŸ§type = Natw âŸ¦ Î“ âŸ§C âŸ¦ A âŸ§T
  âŸ¦ Tms-i Î“ Î” âŸ§type = Natw âŸ¦ Î“ âŸ§C âŸ¦ Î” âŸ§C


  âŸ¦_âŸ§ : {i : term-index} â†’ term i â†’ âŸ¦ i âŸ§type

  âŸ¦ u [ Ïƒ ] âŸ§ = âŸ¦ u âŸ§ âˆ˜n âŸ¦ Ïƒ âŸ§
  âŸ¦ Ï€â‚‚ {Î” = Î”} {A} Ïƒ âŸ§ = Ï€â‚‚n âŸ¦ Î” âŸ§C âŸ¦ A âŸ§T âŸ¦ Ïƒ âŸ§
  âŸ¦ lam {Î“ = Î“} {A} {B} u âŸ§ =
    lamp {F = âŸ¦ Î“ âŸ§C} {G = âŸ¦ A âŸ§T} {H = âŸ¦ B âŸ§T} âŸ¦ u âŸ§
  âŸ¦ app {Î“ = Î“} {A} {B} f âŸ§ =
    appp {F = âŸ¦ Î“ âŸ§C} {G = âŸ¦ A âŸ§T} {H = âŸ¦ B âŸ§T} âŸ¦ f âŸ§

  âŸ¦ id âŸ§ = idn
  âŸ¦ Ïƒ âˆ˜ Î½ âŸ§ = âŸ¦ Ïƒ âŸ§ âˆ˜n âŸ¦ Î½ âŸ§ 
  âŸ¦ Îµ âŸ§ = !p
  âŸ¦ Ïƒ , u âŸ§ = <_,_> âŸ¦ Ïƒ âŸ§ âŸ¦ u âŸ§
  âŸ¦ Ï€â‚ {Î” = Î”} {A} Ïƒ âŸ§ = (Ï€â‚n âŸ¦ Î” âŸ§C âŸ¦ A âŸ§T) âŸ¦ Ïƒ âŸ§

  âŸ¦ Ï€â‚‚Î² {Ïƒ = Ïƒ} {u = u} i âŸ§ = Ï€â‚‚nÎ² {Î¸ = âŸ¦ Ïƒ âŸ§} {Î· = âŸ¦ u âŸ§} i
  âŸ¦ Î² {Î“ = Î“} {A} {B} {u} i âŸ§ =
    Î²p {F = âŸ¦ Î“ âŸ§C} {G = âŸ¦ A âŸ§T} {H = âŸ¦ B âŸ§T} {Î¸ = âŸ¦ u âŸ§} i
  âŸ¦ Î· {Î“ = Î“} {A} {B} {f} i âŸ§ =
    Î·p {F = âŸ¦ Î“ âŸ§C} {G = âŸ¦ A âŸ§T} {H = âŸ¦ B âŸ§T} {Î¸ = âŸ¦ f âŸ§} i
  âŸ¦ lam[] {Î“ = Î“} {Î”} {A} {B} {u} {Ïƒ} i âŸ§ =
    natlam {F = âŸ¦ Î” âŸ§C} {G = âŸ¦ A âŸ§T} {H = âŸ¦ B âŸ§T} {K = âŸ¦ Î“ âŸ§C} {Î¸ = âŸ¦ u âŸ§} {Î· = âŸ¦ Ïƒ âŸ§} i
  
  âŸ¦ idâˆ˜ {Ïƒ = Ïƒ} i âŸ§ = idâˆ˜n {Î¸ = âŸ¦ Ïƒ âŸ§} i
  âŸ¦ âˆ˜id {Ïƒ = Ïƒ} i âŸ§ = âˆ˜idn {Î¸ = âŸ¦ Ïƒ âŸ§} i
  âŸ¦ âˆ˜âˆ˜ {Ïƒ = Ïƒ} {Î½} {Ï} i âŸ§ = âˆ˜âˆ˜n {Î¸ = âŸ¦ Ïƒ âŸ§} {âŸ¦ Î½ âŸ§} {âŸ¦ Ï âŸ§} i
  âŸ¦ ÎµÎ· {Ïƒ = Ïƒ} i âŸ§ = !pÎ· {Î¸ = âŸ¦ Ïƒ âŸ§} i
  âŸ¦ Ï€â‚Î² {Ïƒ = Ïƒ} {u} i âŸ§ = Ï€â‚nÎ² {Î¸ = âŸ¦ Ïƒ âŸ§} {Î· = âŸ¦ u âŸ§} i
  âŸ¦ Ï€Î· {Î“} {Î”} {A} {Ïƒ = Ïƒ} i âŸ§ = Ï€nÎ· {F = âŸ¦ Î“ âŸ§C} {G = âŸ¦ Î” âŸ§C} {H = âŸ¦ A âŸ§T} {Î¸ = âŸ¦ Ïƒ âŸ§} i
  âŸ¦ ,âˆ˜ {Ïƒ = Ïƒ} {Î½} {u} i âŸ§ = ,âˆ˜n {Î¸ = âŸ¦ Ïƒ âŸ§} {âŸ¦ u âŸ§} {âŸ¦ Î½ âŸ§} i

  âŸ¦ isSetTm p q i j âŸ§ = isSetnat (Î» j â†’ âŸ¦ p j âŸ§) (Î» j â†’ âŸ¦ q j âŸ§) i j
  âŸ¦ isSetTms p q i j âŸ§ = isSetnat (Î» j â†’ âŸ¦ p j âŸ§) (Î» j â†’ âŸ¦ q j âŸ§) i j
